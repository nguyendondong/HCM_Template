# üöÄ HCM Heritage Template - Quick Start Guide

## üìã Prerequisites

```bash
# Ki·ªÉm tra requirements
node --version  # v18+ required for Vite + Firebase
yarn --version  # v1.22+ recommended
git --version   # Latest version
```

## üî• Firebase Project Setup

### 1. T·∫°o Firebase Project

1. V√†o [Firebase Console](https://console.firebase.google.com/)
2. **Create a project** ‚Üí ƒê·∫∑t t√™n "HCM Heritage Template"
3. Enable Google Analytics (recommended)
4. Ch·ªçn **Default Account for Firebase**

### 2. C·∫•u h√¨nh Firebase Services

#### Authentication
```bash
# V√†o Authentication ‚Üí Sign-in method
‚úÖ Enable Email/Password
‚úÖ Enable Google (optional)
‚úÖ Enable Anonymous (for guests)
```

#### Firestore Database
```bash
# V√†o Firestore Database ‚Üí Create database
‚úÖ Start in test mode (for development)
‚úÖ Choose location: asia-southeast1 (Singapore)
```

#### Storage
```bash
# V√†o Storage ‚Üí Get started
‚úÖ Start in test mode
‚úÖ Use same location as Firestore
```

#### Hosting (Optional)
```bash
# V√†o Hosting ‚Üí Get started
‚úÖ Setup domain for production deploy
```

## üéØ Environment Configuration

### 1. Clone v√† Setup Project

```bash
# Clone project
git clone <repository-url>
cd HCM_Template

# Install dependencies
yarn install

# Setup environment
cp .env.example .env
```

### 2. Get Firebase Config

1. **Project Settings** (‚öôÔ∏è) ‚Üí **General** tab
2. **Your apps** ‚Üí **Add app** ‚Üí **Web** (</>)
3. App nickname: "HCM Heritage Web"
4. ‚úÖ **Also set up Firebase Hosting**
5. Copy `firebaseConfig` object

### 3. Configure .env File

```env
# ===========================================
# üî• FIREBASE CONFIGURATION - DEVELOPMENT
# ===========================================
# For emulator development, these can be dummy values
# but they MUST be present for Firebase SDK to initialize

VITE_FIREBASE_API_KEY=your_api_key_here
VITE_FIREBASE_AUTH_DOMAIN=hcmtemplate.firebaseapp.com
VITE_DATABASE_URL=https://hcmtemplate-default-rtdb.asia-southeast1.firebasedatabase.app
VITE_FIREBASE_PROJECT_ID=hcmtemplate
VITE_FIREBASE_STORAGE_BUCKET=hcmtemplate.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=123456789
VITE_FIREBASE_APP_ID=1:123456789:web:your-app-id
VITE_MEASUREMENT_ID=G-YOUR-MEASUREMENT-ID

# ===========================================
# ‚öôÔ∏è  ENVIRONMENT SETTINGS - DEVELOPMENT
# ===========================================

VITE_USE_EMULATORS=true
VITE_ENV=development

# ===========================================
# üîß EMULATOR CONFIGURATION
# ===========================================

VITE_EMULATOR_HOST=127.0.0.1
VITE_FIRESTORE_EMULATOR_PORT=8084
VITE_AUTH_EMULATOR_PORT=9099
VITE_STORAGE_EMULATOR_PORT=9199

# ===========================================
# üë®‚Äçüíº ADMIN SETTINGS
# ===========================================

VITE_ADMIN_SESSION_EXPIRE_DAYS=3

# ===========================================
# üîß FIREBASE SERVICE ACCOUNT
# ===========================================

GOOGLE_APPLICATION_CREDENTIALS=./hcmtemplate.json
```

**‚ö†Ô∏è Important**: Ngay c·∫£ khi d√πng emulator, b·∫°n v·∫´n c·∫ßn ƒëi·ªÅn ƒë·∫ßy ƒë·ªß Firebase config keys ƒë·ªÉ tr√°nh l·ªói `invalid-api-key`.

## üõ†Ô∏è Development Workflow

### 1. Verify Environment Setup

```bash
# Ki·ªÉm tra environment variables
yarn check-env
```

### 2. Start Firebase Emulators

```bash
# Start Firebase emulators (Auth, Firestore, Storage)
yarn firebase:emulators

# Ho·∫∑c start v·ªõi UI dashboard
yarn firebase:emulators:ui
```

### 3. Seed Development Data

```bash
# Seed refined data v√†o emulator (safe)
yarn data:seed

# Ho·∫∑c seed specific collection
yarn seed heritage-spots
yarn seed vr-experiences
yarn seed mini-games
yarn seed documents

# View seeded data at: http://127.0.0.1:4004/firestore
```

### 4. Start Development Server

```bash
# Start development server (emulator mode)
yarn dev

# Ho·∫∑c start v·ªõi production Firebase (kh√¥ng emulator)
yarn dev:prod

# Server will start at http://localhost:5173
```

## üìä Data Management System

### Available Scripts

| Command | Purpose | Environment | Safety |
|---------|---------|-------------|---------|
| `yarn check-env` | Verify Firebase config | All | ‚úÖ Safe |
| `yarn data:seed` | Seed refined data to emulator | Emulator | ‚úÖ Safe |
| `yarn data:seed:prod` | Seed data to production | Production | ‚ö†Ô∏è **Dangerous** |
| `yarn data:seed:prod:safe` | Seed with manual confirm | Production | ‚ö†Ô∏è **Requires --confirm** |
| `yarn seed [collection]` | Seed specific collection | Emulator | ‚úÖ Safe |
| `yarn seed:prod [collection]` | Seed specific to production | Production | ‚ö†Ô∏è **Dangerous** |

### Available Data Collections

Sau khi seed data, Firestore s·∫Ω ch·ª©a:

```
üî• Firestore Collections:
‚îú‚îÄ‚îÄ heritage-spots/         # Di t√≠ch l·ªãch s·ª≠ HCM
‚îú‚îÄ‚îÄ vr-content/            # Tr·∫£i nghi·ªám VR
‚îú‚îÄ‚îÄ documents/             # T√†i li·ªáu l·ªãch s·ª≠
‚îú‚îÄ‚îÄ mini-games/            # Mini games t∆∞∆°ng t√°c
‚îú‚îÄ‚îÄ landing-page-content/  # N·ªôi dung trang ch·ªß
‚îî‚îÄ‚îÄ configuration/         # C·∫•u h√¨nh h·ªá th·ªëng
```

### Seed Data Files

```
/data/seed/
‚îú‚îÄ‚îÄ heritage-spots-refined.json      # C√°c di t√≠ch HCM
‚îú‚îÄ‚îÄ vr-content-refined.json         # N·ªôi dung VR experiences
‚îú‚îÄ‚îÄ documents-refined.json          # T√†i li·ªáu l·ªãch s·ª≠
‚îú‚îÄ‚îÄ mini-games-refined.json         # Game content
‚îú‚îÄ‚îÄ landing-page-content.json       # Homepage content
‚îú‚îÄ‚îÄ seed-configuration-refined.json # System config
‚îî‚îÄ‚îÄ README.md                       # H∆∞·ªõng d·∫´n seed data
```

## üöÄ Production Deployment

### Chu·∫©n b·ªã Production

1. **T·∫°o .env.production:**
```env
# ===========================================
# üî• FIREBASE CONFIGURATION - PRODUCTION
# ===========================================

VITE_FIREBASE_API_KEY=your_production_api_key
VITE_FIREBASE_AUTH_DOMAIN=hcmtemplate.firebaseapp.com
VITE_DATABASE_URL=https://hcmtemplate-default-rtdb.asia-southeast1.firebasedatabase.app
VITE_FIREBASE_PROJECT_ID=hcmtemplate
VITE_FIREBASE_STORAGE_BUCKET=hcmtemplate.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
VITE_FIREBASE_APP_ID=your_app_id
VITE_MEASUREMENT_ID=your_measurement_id

# ===========================================
# ‚öôÔ∏è  ENVIRONMENT SETTINGS - PRODUCTION
# ===========================================

VITE_USE_EMULATORS=false
VITE_ENV=production

# ===========================================
# üë®‚Äçüíº ADMIN SETTINGS
# ===========================================

VITE_ADMIN_SESSION_EXPIRE_DAYS=3
```

2. **Deploy Firestore Rules:**
```bash
yarn firebase:deploy:rules
```

3. **Seed Production Data (C·∫©n th·∫≠n!):**
```bash
# C·∫ßn service account key v√† --confirm flag
yarn data:seed:prod --confirm

# Ho·∫∑c manual confirmation
yarn data:seed:prod:safe --confirm
```

### Deploy Application

```bash
# Safe deploy ch·ªâ hosting (kh√¥ng ·∫£nh h∆∞·ªüng database)
yarn firebase:deploy:safe

# Ho·∫∑c s·ª≠ d·ª•ng script an to√†n
./scripts/safe-deploy.sh

# Deploy full (hosting + rules)
yarn firebase:deploy

# Deploy ri√™ng hosting
yarn firebase:deploy:hosting
```

## üõ†Ô∏è Development Commands

### Firebase Commands

```bash
# Firebase login
yarn firebase:login

# Start emulators with UI
yarn firebase:emulators:ui

# Deploy hosting only (safe)
yarn firebase:deploy:safe

# Deploy security rules
yarn firebase:deploy:rules

# Serve locally
yarn firebase:serve
```

### Build Commands

```bash
# Development build (with emulators)
yarn build:emulators

# Production build
yarn build:prod

# Development server (emulator mode)
yarn dev

# Development server (production mode)
yarn dev:prod

# Preview build
yarn preview
```

## üîí Security & Production Notes

### Firestore Security Rules

Development rules (hi·ªán t·∫°i trong `firestore.rules`):
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // DEVELOPMENT/EMULATOR MODE ONLY - Allow all operations
    // TODO: Replace with proper security rules before production deployment
    match /{document=**} {
      allow read, write: if true;
    }
  }
}
```

Production rules (ƒë∆∞·ª£c t·∫°o trong `firestore.rules.production`):
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // PRODUCTION RULES - More restrictive

    // Heritage Spots - Public read, admin write
    match /heritage-spots/{document} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.token.admin == true;
    }

    // VR Content - Public read, admin write
    match /vr-content/{document} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.token.admin == true;
    }

    // Documents - Public read, admin write
    match /documents/{document} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.token.admin == true;
    }
  }
}
```

**‚ö†Ô∏è Quan tr·ªçng:** Tr∆∞·ªõc khi deploy production, copy `firestore.rules.production` th√†nh `firestore.rules`!

### Production Safety

1. **Service Account**: File `hcmtemplate.json` c·∫ßn thi·∫øt cho production seeding
2. **Environment Files**:
   - `.env` - Development v·ªõi emulators
   - `.env.production` - Production config
3. **Backup**: Lu√¥n backup data tr∆∞·ªõc khi seed production
4. **Testing**: Lu√¥n test v·ªõi emulator tr∆∞·ªõc
5. **Safe Deploy**: S·ª≠ d·ª•ng `./scripts/safe-deploy.sh` ƒë·ªÉ deploy an to√†n

## üö® Troubleshooting

### Common Issues

#### "Firebase: Error (auth/invalid-api-key)"
```bash
# L·ªói n√†y x·∫£y ra khi thi·∫øu Firebase config keys trong .env
# Ngay c·∫£ khi d√πng emulator, v·∫´n c·∫ßn ƒë·∫ßy ƒë·ªß config keys

# Ki·ªÉm tra .env file c√≥ ƒë·∫ßy ƒë·ªß:
VITE_FIREBASE_API_KEY=...
VITE_FIREBASE_AUTH_DOMAIN=...
VITE_FIREBASE_PROJECT_ID=...
# ... c√°c keys kh√°c

# Kh·ªüi ƒë·ªông l·∫°i development server
yarn dev
```

#### "Firebase not initialized"
```bash
# Check environment variables
yarn check-env

# ƒê·∫£m b·∫£o Firebase emulators ƒëang ch·∫°y
yarn firebase:emulators:ui
```

#### "Permission denied" errors
```bash
# Cho development v·ªõi emulator
# Rules ƒë√£ ƒë∆∞·ª£c c·∫•u h√¨nh ƒë·ªÉ allow write

# Cho production
yarn firebase:deploy:rules
```

#### "No data showing"
```bash
# Re-seed emulator data
yarn data:seed

# Check Firebase emulator UI
# http://127.0.0.1:4004/firestore

# Ho·∫∑c seed specific collection
yarn seed heritage-spots
```

#### "Build errors"
```bash
# Clear v√† reinstall
rm -rf node_modules yarn.lock
yarn install

# Clear Vite cache
yarn dev --force
```

#### "Deploy overwriting database"
```bash
# S·ª≠ d·ª•ng safe deploy script
./scripts/safe-deploy.sh

# Ho·∫∑c deploy hosting only
yarn firebase:deploy:safe

# Ki·ªÉm tra environment tr∆∞·ªõc deploy
cat .env | grep VITE_USE_EMULATORS
```

## üìñ Next Steps

Sau khi setup th√†nh c√¥ng:

1. ‚úÖ **Explore App**: Kh√°m ph√° c√°c collection ƒë√£ ƒë∆∞·ª£c seed
2. ‚úÖ **Customize Content**: Th√™m heritage spots m·ªõi trong Firestore
3. ‚úÖ **Test Features**: VR experiences, documents, mini games
4. ‚úÖ **Add Authentication**: Implement user login system
5. ‚úÖ **Deploy Production**: Push to Firebase Hosting

## üÜò Support

- **Firebase Console**: [console.firebase.google.com](https://console.firebase.google.com)
- **Emulator UI**: [127.0.0.1:4004](http://127.0.0.1:4004) (khi ch·∫°y emulators)
- **Project Documentation**: Xem c√°c file `.md` trong project
- **Environment Setup**: Ki·ªÉm tra `.env.example` v√† `.env.production`

## üìÅ Project Structure

```
HCM_Template/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/         # React components
‚îÇ   ‚îú‚îÄ‚îÄ pages/             # Page components
‚îÇ   ‚îú‚îÄ‚îÄ services/          # Firebase services
‚îÇ   ‚îú‚îÄ‚îÄ contexts/          # React contexts
‚îÇ   ‚îú‚îÄ‚îÄ lib/               # Firebase config
‚îÇ   ‚îî‚îÄ‚îÄ types/             # TypeScript types
‚îú‚îÄ‚îÄ data/seed/             # Seed data files
‚îú‚îÄ‚îÄ scripts/               # Build & deployment scripts
‚îú‚îÄ‚îÄ .env.example           # Environment template
‚îú‚îÄ‚îÄ .env.production        # Production config
‚îú‚îÄ‚îÄ firebase.json          # Firebase configuration
‚îú‚îÄ‚îÄ firestore.rules        # Development rules
‚îú‚îÄ‚îÄ firestore.rules.production  # Production rules
‚îî‚îÄ‚îÄ QUICK_START.md         # This guide
```

## üîß Scripts Overview

| Script | Purpose | Environment |
|---------|---------|-------------|
| `yarn dev` | Development server v·ªõi emulators | Development |
| `yarn dev:prod` | Development server v·ªõi production Firebase | Production |
| `yarn build:prod` | Build cho production | Production |
| `yarn data:seed` | Seed data v√†o emulator | Development |
| `yarn firebase:emulators:ui` | Start emulators v·ªõi UI | Development |
| `yarn firebase:deploy:safe` | Deploy hosting an to√†n | Production |
| `./scripts/safe-deploy.sh` | Deploy script v·ªõi confirmation | Production |
| `yarn check-env` | Ki·ªÉm tra environment variables | All |
